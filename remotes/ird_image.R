###Data Module
# Function for module UI
ird_image_ui <- function(id) {
  ns <- NS(id)
  
  tabPanel(title=uiOutput(ns("title_panel")),value="ird",
           fluidRow(
           uiOutput(ns("img"))
           )
  )  
}

# Function for module server
ird_image_server <- function(input, output, session,data,dsd,query) {
  ns<-session$ns  
  
  output$img <-renderUI({
     df<-as.data.frame(data)
     ird_image.caption <-if (!is.null(query$ird_image.caption)){query$ird_image.caption}else{NULL}
     ird_image.imageCol <-if (!is.null(query$ird_image.imageCol)){query$ird_image.imageCol}else{NULL}
     img<-df[ird_image.imageCol]
     #img<-"base64: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"
     test<-gsub("base64:","",img)
     img_url<-sprintf("<center><img src=\"data:image/png;base64,\n%s\" alt=\"image\" /></center>",  test)
    HTML(img_url)
  })
  
}
####